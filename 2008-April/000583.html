<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Kiwi-users] nbd mystery
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/kiwi-users/2008-April/index.html" >
   <LINK REL="made" HREF="mailto:kiwi-users%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-users%5D%20nbd%20mystery&In-Reply-To=%3C1208793290.28576.19.camel%40acme.pacific%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000582.html">
   <LINK REL="Next"  HREF="000591.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Kiwi-users] nbd mystery</H1>
    <B>Roger Oberholtzer</B> 
    <A HREF="mailto:kiwi-users%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-users%5D%20nbd%20mystery&In-Reply-To=%3C1208793290.28576.19.camel%40acme.pacific%3E"
       TITLE="[Kiwi-users] nbd mystery">roger at opq.se
       </A><BR>
    <I>Mon Apr 21 17:54:50 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000582.html">[Kiwi-users] Repository Problem + Encryption Question
</A></li>
        <LI>Next message: <A HREF="000591.html">[Kiwi-users] nbd mystery
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#583">[ date ]</a>
              <a href="thread.html#583">[ thread ]</a>
              <a href="subject.html#583">[ subject ]</a>
              <a href="author.html#583">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We have a real mystery on our hands. Perhaps someone on the list can
help.

I have made some images with KIWI that allow systems to boot openSUSE
10.3 as a diskless OS. In fact, I made one set of images and we use
these for all our systems. It has been working great. There are only two
basic hardware layouts for this.

The images boot with PXE, and at some point, a root file system is
mounted via NBD.

We now have a situation where some systems fail when they get to the
point of mounting the root file system with NBD. They do not always
fail, but they fail more often than not. They are used in a road
vehicle, so they do get powered off/on on a regular basis.

We cannot see any difference in the hardware. They are SuperMicro 1U
computers. Of course, even though they are the same model and all, there
are always differences. But none that we can see.

When we get the failure, we can investigate a bit with ALT-F3 and
ALT-F4.

With ALT-F3, things look the same as usual, except at the end, where we
get the message:

+ echo '------&gt; Mounting NBD root system: 10.1.6.2o 2000
[/dev/nbd1] ...'
Error: Cannot open NBD: No such file or directory
+ systemException 'Failed to setup /dev/nbd1 device' reboot

At the same time, the last thing on ALT-F4 is:

nbd: registered device at major 43

which is as expected.


Sometimes, it will go as far as printing Negotiation:, but then fail.

The odd thing is that a different computer will always boot from our
kiwi images.

On the server, the nbd-server process is happily running. Restarting it
makes no difference.

The difficulty here is that nbd is a very secretive program. There is no
debugging. I do not know if it is getting requests and failing with some
great reason. Or if the requests never arrive. I will have access to
such troubled systems tomorrow, so I can do proper testing then. I am
currently only getting user reports. So, any bits of advice are welcome!



-- 
Roger Oberholtzer

OPQ Systems / Ramb&#246;ll RST

Ramb&#246;ll Sverige AB
Kapellgr&#228;nd 7
P.O. Box 4205
SE-102 65 Stockholm, Sweden

Office: Int +46 8-615 60 20
Mobile: Int +46 70-815 1696


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000582.html">[Kiwi-users] Repository Problem + Encryption Question
</A></li>
	<LI>Next message: <A HREF="000591.html">[Kiwi-users] nbd mystery
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#583">[ date ]</a>
              <a href="thread.html#583">[ thread ]</a>
              <a href="subject.html#583">[ subject ]</a>
              <a href="author.html#583">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/kiwi-users">More information about the Kiwi-users
mailing list</a><br>
</body></html>
