<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Kiwi-users] Installing a Kiwi image on a different partition
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/kiwi-users/2010-September/index.html" >
   <LINK REL="made" HREF="mailto:kiwi-users%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-users%5D%20Installing%20a%20Kiwi%20image%20on%20a%20different%20partition&In-Reply-To=%3C4CA201E6.7000808%40novell.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002049.html">
   <LINK REL="Next"  HREF="002051.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Kiwi-users] Installing a Kiwi image on a different partition</H1>
    <B>Robert Schweikert</B> 
    <A HREF="mailto:kiwi-users%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-users%5D%20Installing%20a%20Kiwi%20image%20on%20a%20different%20partition&In-Reply-To=%3C4CA201E6.7000808%40novell.com%3E"
       TITLE="[Kiwi-users] Installing a Kiwi image on a different partition">rschweikert at novell.com
       </A><BR>
    <I>Tue Sep 28 16:55:34 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="002049.html">[Kiwi-users] Installing a Kiwi image on a different partition
</A></li>
        <LI>Next message: <A HREF="002051.html">[Kiwi-users] Installing a Kiwi image on a different partition
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2050">[ date ]</a>
              <a href="thread.html#2050">[ thread ]</a>
              <a href="subject.html#2050">[ subject ]</a>
              <a href="author.html#2050">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

On 09/28/2010 10:24 AM, <A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-users">luis.arruda at emc.com</A> wrote:
&gt;&gt;<i> -----Original Message-----
</I>&gt;&gt;<i> From: Robert Schweikert [mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-users">rschweikert at novell.com</A>]
</I>&gt;&gt;<i> Sent: Tuesday, September 28, 2010 9:29 AM
</I>&gt;<i> 
</I>&gt;<i> &lt;snip&gt;
</I>&gt;&gt;&gt;<i> I see... That's interesting as when I do a loopback mount of the
</I>&gt;&gt;&gt;<i> image, there doesn't appear to be a valid initrd in /boot. At least
</I>&gt;&gt;&gt;<i> it's nothing I can use to feed into grub for booting purposes.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The initrd is valid as menu.lst in the /boot of the ISO image points to
</I>&gt;&gt;<i> it for install purposes.
</I>&gt;<i> 
</I>&gt;<i> Ah, okay... I think I understand now. I was looking at the gzip'ed raw image file on the ISO image and that does not contain a valid initrd, which is why I assumed that a valid one would be generated as part of first boot after the image is dd'ed to the hard drive. So I guess the proper procedure would be something like this:
</I>&gt;<i> 
</I>&gt;<i> 1) Use the ISO's initrd for first boot of the installation
</I>&gt;<i> 2) After the initial installation process completes, update menu.lst with the real initrd that gets created at first boot.
</I>
There is no initrd generated at first boot. The ISO image and the image
that gets dumped to the storage device of the machine have the same
initrd. This initrd is generated by Kiwi during the create step.


&gt;<i> 
</I>&gt;<i> Does this sound reasonable?
</I>
Your procedure should be something like this.

- Build the kiwi image
  - include grub and parted in the initrd by using the bootinclude
    attribute
  - set it up with oem-partitioninstall
- Use the preHWdetect hook script
  - first check if the drive is already partitioned, if yes exit
  - else create 2 partitions
  - install grub into the MBR using grub-install
- Now the regular kiwi install process will show you a choice of
  partitions to install you image into
- After the dump use the postImageDump hook to
  modify the menu.lst file such that it points to the menu.lst file
  of the partition where you just dumped the image.

HTH,
Robert
&gt;<i> 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> HTH,
</I>&gt;&gt;<i> Robert
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> Robert Schweikert                           MAY THE SOURCE BE WITH YOU
</I>&gt;&gt;<i> Software Engineer Consultant                          LINUX
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-users">rschweikert at novell.com</A>
</I>&gt;&gt;<i> 781-464-8147
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Novell
</I>&gt;&gt;<i> Making IT Work As One
</I>&gt;<i> 
</I>
-- 
Robert Schweikert                           MAY THE SOURCE BE WITH YOU
Software Engineer Consultant                          LINUX
<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-users">rschweikert at novell.com</A>
781-464-8147

Novell
Making IT Work As One

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002049.html">[Kiwi-users] Installing a Kiwi image on a different partition
</A></li>
	<LI>Next message: <A HREF="002051.html">[Kiwi-users] Installing a Kiwi image on a different partition
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2050">[ date ]</a>
              <a href="thread.html#2050">[ thread ]</a>
              <a href="subject.html#2050">[ subject ]</a>
              <a href="author.html#2050">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/kiwi-users">More information about the Kiwi-users
mailing list</a><br>
</body></html>
